<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="09-线程和进程"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="09-线程和进程"><meta property="og:description" content="09-线程和进程"><meta property="og:type" content="article"><meta property="og:url" content="http://mmzhang.github.io/docs/01-python%E5%9F%BA%E7%A1%80/09-%E7%BA%BF%E7%A8%8B%E5%92%8C%E8%BF%9B%E7%A8%8B/"><meta property="article:section" content="docs"><title>09-线程和进程 | wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.82c5dbd23447cee0b4c2aa3ed08ce0961faa40e1fa370eee4f8c9f02e0d46b5f.css integrity="sha256-gsXb0jRHzuC0wqo+0Izglh+qQOH6Nw7uT4yfAuDUa18=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.edabb1e1c1dab513deb08bceb10e1674137bdd91a67bab297595a5a986896064.js integrity="sha256-7aux4cHatRPesIvOsQ4WdBN73ZGme6spdZWlqYaJYGQ=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-699140e482a51d977f76ca20240ab0ac class=toggle>
<label for=section-699140e482a51d977f76ca20240ab0ac class="flex justify-between"><a role=button>es</a></label><ul><li><a href=/docs/es/%E9%85%8D%E7%BD%AE/>配置</a></li></ul></li><li><input type=checkbox id=section-61555e73c79c19769a03f45aa4e846c1 class=toggle>
<label for=section-61555e73c79c19769a03f45aa4e846c1 class="flex justify-between"><a role=button>26-微服务</a></label><ul><li><a href=/docs/26-%E5%BE%AE%E6%9C%8D%E5%8A%A1/go%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/>go内存模型</a></li><li><a href=/docs/26-%E5%BE%AE%E6%9C%8D%E5%8A%A1/go%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/>go异常处理</a></li><li><a href=/docs/26-%E5%BE%AE%E6%9C%8D%E5%8A%A1/reids%E5%A4%A7%E9%9B%86%E7%BE%A4%E6%96%B9%E6%A1%88/>reids大集群方案</a></li><li><a href=/docs/26-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%A4%9A%E7%A7%9F%E6%88%B7%E5%BD%B1%E5%AD%90%E5%8F%91%E5%B8%83/>多租户(影子发布)</a></li><li><a href=/docs/26-%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%B7%A5%E7%A8%8B%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84/>工程项目结构</a></li></ul></li><li><input type=checkbox id=section-dbbf45d6e336dd59365466b472b4c2b6 class=toggle>
<label for=section-dbbf45d6e336dd59365466b472b4c2b6 class="flex justify-between"><a role=button>25-golang</a></label><ul><li><a href=/docs/25-golang/%E9%9D%A2%E8%AF%95/>面试</a></li></ul></li><li><input type=checkbox id=section-f08009bfa856fb7663409248acfe2cef class=toggle>
<label for=section-f08009bfa856fb7663409248acfe2cef class="flex justify-between"><a role=button>24-rust</a></label><ul></ul></li><li><input type=checkbox id=section-8b28b06ac4dd3aece1b29bee32d5c602 class=toggle>
<label for=section-8b28b06ac4dd3aece1b29bee32d5c602 class="flex justify-between"><a role=button>23-前端</a></label><ul></ul></li><li><input type=checkbox id=section-8232bf6c6676179b598aaee3faba02cb class=toggle>
<label for=section-8232bf6c6676179b598aaee3faba02cb class="flex justify-between"><a role=button>22-日常命令</a></label><ul><li><a href=/docs/22-%E6%97%A5%E5%B8%B8%E5%91%BD%E4%BB%A4/%E7%94%B5%E8%84%91%E9%85%8D%E7%BD%AE/>电脑配置</a></li></ul></li><li><input type=checkbox id=section-23a8527df3397ce268a3b1a871ef4d90 class=toggle>
<label for=section-23a8527df3397ce268a3b1a871ef4d90 class="flex justify-between"><a role=button>21-kubernetes</a></label><ul><li><a href=/docs/21-kubernetes/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/>常用命令</a></li><li><a href=/docs/21-kubernetes/%E6%8E%A2%E9%92%88/>探针</a></li></ul></li><li><input type=checkbox id=section-777fdc97635e6502949855bc095ee6aa class=toggle>
<label for=section-777fdc97635e6502949855bc095ee6aa class="flex justify-between"><a role=button>20-airflow实战</a></label><ul><li><a href=/docs/20-airflow%E5%AE%9E%E6%88%98/%E4%BD%BF%E7%94%A8celerykubernetesexecutor/>使用celerykubernetesexecutor</a></li></ul></li><li><input type=checkbox id=section-5155dad3123cddc005a7f9ed86d6db12 class=toggle>
<label for=section-5155dad3123cddc005a7f9ed86d6db12 class="flex justify-between"><a role=button>19-hugo-book</a></label><ul><li><a href=/docs/19-hugo-book/hugo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/>Hugo搭建博客</a></li><li><a href=/docs/19-hugo-book/github%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E6%89%98%E7%AE%A1/>Github静态页面托管</a></li><li><a href=/docs/19-hugo-book/%E6%B7%BB%E5%8A%A0%E9%98%BF%E9%87%8C%E4%BA%91%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/>添加阿里云域名解析</a></li></ul></li><li><input type=checkbox id=section-e2a7cdf3c35751c10fd1e5474ec25934 class=toggle>
<label for=section-e2a7cdf3c35751c10fd1e5474ec25934 class="flex justify-between"><a role=button>18-安装脚本</a></label><ul><li><a href=/docs/18-%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC/nginx_uwsgi/>Nginx_uwsgi</a></li><li><a href=/docs/18-%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC/%E5%AE%89%E8%A3%85mariadb/>安装mariaDB</a></li><li><a href=/docs/18-%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC/%E5%AE%89%E8%A3%85python3.6/>安装python3</a></li></ul></li><li><input type=checkbox id=section-9ae7bb7204f29d395ff4374aa648c2d6 class=toggle>
<label for=section-9ae7bb7204f29d395ff4374aa648c2d6 class="flex justify-between"><a role=button>17-emacs</a></label><ul><li><a href=/docs/17-emacs/emacs%E9%85%8D%E7%BD%AE/>emacs配置</a></li></ul></li><li><input type=checkbox id=section-ad28360255e5707f82f748667937828d class=toggle>
<label for=section-ad28360255e5707f82f748667937828d class="flex justify-between"><a role=button>16-面试题</a></label><ul></ul></li><li><input type=checkbox id=section-7fe75dce01e7dbdc6caf2191b7f35824 class=toggle>
<label for=section-7fe75dce01e7dbdc6caf2191b7f35824 class="flex justify-between"><a role=button>15-集成开发</a></label><ul><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/01-git_flow%E5%B7%A5%E4%BD%9C%E6%B5%81%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/>01-git_flow工作流使用指南</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/02-jenkins%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%9701/>02-jenkins配置指南01</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/03-jenkins%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%9702/>03-jenkins配置指南02</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/05-pycharm%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E9%9B%86%E6%88%90%E8%AE%BE%E7%BD%AE/>05-Pycharm代码风格集成设置</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/06-pycharm%E9%9B%86%E6%88%90%E6%A3%80%E6%9F%A5%E5%B7%A5%E5%85%B7/>06-Pycharm集成检查工具</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/08-tox%E9%9B%86%E6%88%90%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/>08-tox集成使用指南</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/10-git_rebase/>10-git_rebase</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/celery%E7%9A%84%E4%BD%BF%E7%94%A8/>celery的使用</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/docker%E4%BD%BF%E7%94%A8/>Docker使用</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/memcached%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E5%90%AF%E5%8A%A8/>memcached的安装和启动</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/rabbitmq%E4%BD%BF%E7%94%A8/>rabbitmq使用</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/scrapyd%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/>scrapyd使用方法</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/spiderkeeper%E6%8E%A5%E5%8F%A3/>spiderKeeper接口</a></li><li><a href=/docs/15-%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91/%E5%91%BD%E4%BB%A4/>命令</a></li></ul></li><li><input type=checkbox id=section-1b4820c28a98067c0fef5225173ee99e class=toggle>
<label for=section-1b4820c28a98067c0fef5225173ee99e class="flex justify-between"><a role=button>14-docker</a></label><ul><li><a href=/docs/14-docker/01-centos7%E5%AE%89%E8%A3%85docker/>01-CentOS7安装docker</a></li><li><a href=/docs/14-docker/02-docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/>02-Docker常用命令</a></li><li><a href=/docs/14-docker/03-docker-compose.yaml%E9%85%8D%E7%BD%AE/>03-docker-compose</a></li></ul></li><li><input type=checkbox id=section-4a497c000e3d6340562da26fb030ea6b class=toggle>
<label for=section-4a497c000e3d6340562da26fb030ea6b class="flex justify-between"><a role=button>13-tensorflow</a></label><ul><li><a href=/docs/13-tensorflow/01-tensorflow%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/>01-tensorflow环境搭建</a></li><li><a href=/docs/13-tensorflow/02-tf%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E5%92%8C%E6%A8%A1%E6%8B%9F%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/>02-tf基础知识和模拟线性回归</a></li><li><a href=/docs/13-tensorflow/03-%E5%9F%BA%E7%A1%80%E6%8C%87%E4%BB%A4/>03-基础指令</a></li></ul></li><li><input type=checkbox id=section-601bd63086df0516f1ded16b28f48a23 class=toggle>
<label for=section-601bd63086df0516f1ded16b28f48a23 class="flex justify-between"><a role=button>12-机器学习数据分析sklearn</a></label><ul></ul></li><li><input type=checkbox id=section-572e721f6e43078bfa32034e84bbe4b4 class=toggle>
<label for=section-572e721f6e43078bfa32034e84bbe4b4 class="flex justify-between"><a role=button>11-Python设计模式</a></label><ul><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/00-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%BB%8B%E7%BB%8D/>00-Python设计模式介绍</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/01-%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/>01-工厂模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/02-%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/>02-建造者模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/03-%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/>03-原型模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/04-%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/>04-适配器模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/05-%E4%BF%AE%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/>05-修饰器模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/06-%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/>06-外观模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/07-%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/>07-享元模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/08-mvc%E6%A8%A1%E5%BC%8F/>08-MVC模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/09-%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/>09-代理模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/10-%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/>10-责任链模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/11-%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/>11-命令模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/12-%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/>12-解释器模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/13-%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/>13-观察者模式</a></li><li><a href=/docs/11-python%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/14-%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/>14-状态模式</a></li></ul></li><li><input type=checkbox id=section-89d843abaf0e16c5973def7508f4dea9 class=toggle>
<label for=section-89d843abaf0e16c5973def7508f4dea9 class="flex justify-between"><a role=button>10-优化</a></label><ul><li><a href=/docs/10-%E4%BC%98%E5%8C%96/celery%E5%92%8Crabbitmq/>Celery和RabbitMQ</a></li><li><a href=/docs/10-%E4%BC%98%E5%8C%96/mysql%E4%B8%BB%E4%BB%8E%E5%88%86%E7%A6%BB/>MySQL主从分离</a></li><li><a href=/docs/10-%E4%BC%98%E5%8C%96/mysql%E4%BC%98%E5%8C%96/>MySQL优化</a></li><li><a href=/docs/10-%E4%BC%98%E5%8C%96/%E4%B8%B4%E6%97%B6%E7%AC%94%E8%AE%B0/>临时笔记</a></li><li><a href=/docs/10-%E4%BC%98%E5%8C%96/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/>单元测试</a></li></ul></li><li><input type=checkbox id=section-ffe29355398cb5e5fbcb7014db51e385 class=toggle>
<label for=section-ffe29355398cb5e5fbcb7014db51e385 class="flex justify-between"><a role=button>09-爬虫Scrapy</a></label><ul></ul></li><li><input type=checkbox id=section-db15b7fa49c62b26be2b9a42b704ae65 class=toggle>
<label for=section-db15b7fa49c62b26be2b9a42b704ae65 class="flex justify-between"><a role=button>08-Tornado</a></label><ul><li><a href=/docs/08-tornado/01-%E5%9F%BA%E7%A1%80%E5%BC%80%E5%A7%8Btornado/>01-基础开始tornado</a></li><li><a href=/docs/08-tornado/02-options%E5%8F%82%E6%95%B0%E8%8E%B7%E5%8F%96/>02-options参数获取</a></li><li><a href=/docs/08-tornado/03-%E8%AF%B7%E6%B1%82%E6%A0%B8%E5%93%8D%E5%BA%9401/>03-请求核响应01</a></li><li><a href=/docs/08-tornado/%E9%83%A8%E7%BD%B2%E6%96%B9%E6%B3%95/>部署方法</a></li></ul></li><li><input type=checkbox id=section-34e22bee867c2ec9604e9fe143e7bc00 class=toggle>
<label for=section-34e22bee867c2ec9604e9fe143e7bc00 class="flex justify-between"><a role=button>07-Flask</a></label><ul></ul></li><li><input type=checkbox id=section-fcaf79fa010525235e9c02d2292c09e1 class=toggle>
<label for=section-fcaf79fa010525235e9c02d2292c09e1 class="flex justify-between"><a role=button>06-Django</a></label><ul></ul></li><li><input type=checkbox id=section-d2d2f644095dd7a076c04eb644e8556b class=toggle>
<label for=section-d2d2f644095dd7a076c04eb644e8556b class="flex justify-between"><a role=button>05-Linux</a></label><ul><li><a href=/docs/05-linux/01-linux%E6%93%8D%E4%BD%9C%E9%98%BF%E9%87%8C%E4%BA%91%E4%B8%BB%E6%9C%BA/>01-Linux操作,阿里云主机</a></li><li><a href=/docs/05-linux/02-linux%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%98%B2%E7%81%AB%E5%A2%99/>02-Linux安装软件服务器,防火墙</a></li><li><a href=/docs/05-linux/03-vim%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8/>03-vim文本编辑器</a></li><li><a href=/docs/05-linux/04-redis%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE/>04-redis安装配置</a></li><li><a href=/docs/05-linux/05-%E5%AE%9A%E6%97%B6%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E4%BB%BB%E5%8A%A1/>05-定时执行脚本任务</a></li><li><a href=/docs/05-linux/06-linux%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/>06-Linux操作命令</a></li><li><a href=/docs/05-linux/07-linux%E5%91%BD%E4%BB%A4cat-find/>07-Linux命令cat-find</a></li><li><a href=/docs/05-linux/08-centos7%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%89%A9%E5%B1%95%E7%A3%81%E7%9B%98/>08-Centos7虚拟机扩展磁盘</a></li><li><a href=/docs/05-linux/09-alias%E7%BC%96%E8%BE%91%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4/>09-alias编辑系统命令</a></li><li><a href=/docs/05-linux/10-linux%E5%AE%89%E8%A3%85%E5%B7%A5%E5%85%B7%E5%91%BD%E4%BB%A4/>10-Linux安装工具命令</a></li><li><a href=/docs/05-linux/10-ubantu%E5%AE%89%E8%A3%85%E5%B7%A5%E5%85%B7%E5%91%BD%E4%BB%A4/>10-ubantu安装工具命令</a></li></ul></li><li><input type=checkbox id=section-4da4af1a651273d9ba8c2dff9ae4706f class=toggle>
<label for=section-4da4af1a651273d9ba8c2dff9ae4706f class="flex justify-between"><a role=button>04-数据库</a></label><ul><li><a href=/docs/04-%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E5%B0%8F%E7%BB%93/>各种数据库读写分离小结</a></li></ul></li><li><input type=checkbox id=section-8cca7d9cdaa4fd0ac0539752bdf7b4d6 class=toggle>
<label for=section-8cca7d9cdaa4fd0ac0539752bdf7b4d6 class="flex justify-between"><a role=button>03-Git</a></label><ul><li><a href=/docs/03-git/01-git%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95%E5%92%8C%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B/>01-Git基本用法和工作流程</a></li><li><a href=/docs/03-git/02-git%E8%BF%9B%E9%98%B6/>02-Git进阶</a></li><li><a href=/docs/03-git/03-git%E5%9B%A2%E9%98%9F%E5%BC%80%E5%8F%91/>03-Git团队开发</a></li><li><a href=/docs/03-git/04-git%E5%88%AB%E5%90%8Dalias/>04-Git别名alias</a></li><li><a href=/docs/03-git/05-gitattributes%E8%AE%BE%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7/>05-gitattributes设置文件属性</a></li><li><a href=/docs/03-git/06-gitignore%E8%AE%BE%E7%BD%AE/>06-gitignore设置</a></li><li><a href=/docs/03-git/07-git_flow%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/>07-Git_Flow使用方法</a></li><li><a href=/docs/03-git/08-tox%E4%BD%BF%E7%94%A8/>08-tox使用</a></li><li><a href=/docs/03-git/09-git_rebase/>09-git_rebase</a></li><li><a href=/docs/03-git/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/>常用命令</a></li></ul></li><li><input type=checkbox id=section-ee5f1d736f38101aa1387ddb1895afd8 class=toggle>
<label for=section-ee5f1d736f38101aa1387ddb1895afd8 class="flex justify-between"><a role=button>02-前端HTML-js-css</a></label><ul><li><a href=/docs/02-%E5%89%8D%E7%AB%AFhtml-js-css/01-html%E6%A0%87%E7%AD%BE%E5%92%8Ccss%E6%A0%B7%E5%BC%8F%E8%A1%A8/>01-HTML标签和CSS样式表</a></li><li><a href=/docs/02-%E5%89%8D%E7%AB%AFhtml-js-css/02-javascript-jquary-ajax/>02-Javascript-JQuary-Ajax</a></li><li><a href=/docs/02-%E5%89%8D%E7%AB%AFhtml-js-css/js%E4%B8%ADcookie%E5%80%BC%E7%9A%84%E8%AE%BE%E7%BD%AE%E5%92%8C%E8%8E%B7%E5%8F%96/>js中cookie值的设置和获取</a></li></ul></li><li><input type=checkbox id=section-4ac78bf9efbed769db3bdcc4fadfc3a2 class=toggle checked>
<label for=section-4ac78bf9efbed769db3bdcc4fadfc3a2 class="flex justify-between"><a role=button>01-python基础</a></label><ul><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/01-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C-os%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C-%E6%97%B6%E9%97%B4%E6%97%A5%E6%9C%9F%E5%AF%B9%E8%B1%A1-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-%E8%BF%99%E6%AD%A3%E5%88%99/>01-字符串操作-os文件操作-时间日期对象-面向对象-这正则</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/02-%E5%87%BD%E6%95%B0-reduce-map-nonloca/>02-函数-reduce()-map()-nonloca</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/03-stringio/>03-stringIO</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/04-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B-tcp-udp-bs64/>04-网络编程-TCP-UDP-BS64</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/05-yield%E5%87%BD%E6%95%B0/>05-yield函数</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/06-python%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8D%AE%E5%BA%93/>06-Python操作数据库</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/07-%E8%A3%85%E9%A5%B0%E5%99%A8/>07-装饰器</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/08-%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0/>08-递归函数</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/09-%E7%BA%BF%E7%A8%8B%E5%92%8C%E8%BF%9B%E7%A8%8B/ class=active>09-线程和进程</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/10-%E5%8D%8F%E7%A8%8B%E5%92%8Caiohttp/>10-协程和aiohttp</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/11-%E5%85%83%E7%B1%BB/>11-元类</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/12-anaconda%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/>12-Anaconda创建虚拟环境</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/13-py2%E5%92%8Cpy3%E7%9A%84%E5%8C%BA%E5%88%AB/>13-py2和py3的区别</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/14-%E5%87%BD%E6%95%B0%E7%9A%84%E7%94%A8%E6%B3%95%E6%B1%87%E6%80%BB/>14-函数的用法汇总</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/15-python%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E5%BA%93/>15-python内置函数库</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/shell%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80/>shell脚本语言</a></li><li><a href=/docs/01-python%E5%9F%BA%E7%A1%80/%E4%B8%80%E4%BA%9B%E5%87%BD%E6%95%B0%E7%9A%84%E7%94%A8%E6%B3%95/>一些函数的用法</a></li></ul></li></ul><ul><li><a href=/posts/>博客预览</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>09-线程和进程</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#线程和进程>线程和进程</a><ul><li></li><li><a href=#进程和线程使用>进程和线程使用</a></li></ul></li></ul></nav></aside></header><article class=markdown><h2 id=线程和进程>线程和进程
<a class=anchor href=#%e7%ba%bf%e7%a8%8b%e5%92%8c%e8%bf%9b%e7%a8%8b>#</a></h2><h4 id=1-同步和异步>1. 同步和异步
<a class=anchor href=#1-%e5%90%8c%e6%ad%a5%e5%92%8c%e5%bc%82%e6%ad%a5>#</a></h4><p>针对结果</p><ul><li>同步 - 多任务，多个任务执行的时候有先后的顺序， 必须一个先执行后， 另外一个才能继续执行， 只有一条运行主线</li><li>异步 - 多任务， 多个任务之间执行没有想先后顺序， 可以同时运行， 执行时先后顺序不会对程序有什么影响， 存在多条运行主线</li></ul><h4 id=2-阻塞和非阻塞>2. 阻塞和非阻塞
<a class=anchor href=#2-%e9%98%bb%e5%a1%9e%e5%92%8c%e9%9d%9e%e9%98%bb%e5%a1%9e>#</a></h4><p>针对运行状态 线程的状态（就绪、运行、阻塞）</p><ul><li>阻塞 - 从调用者的角度出发， 如果在调用的时候， 被卡住， 不能再继续往下执行， 需要等待， 就是 阻塞</li><li>非阻塞 - 从调用者的角度出发， 如果在调用的时候， 没有被卡住， 能够继续向下执行， 无需等待， 就是 非阻塞</li></ul><h4 id=3-并发和并行>3. 并发和并行
<a class=anchor href=#3-%e5%b9%b6%e5%8f%91%e5%92%8c%e5%b9%b6%e8%a1%8c>#</a></h4><ul><li>并发 - 同时处理任务</li><li>并行 - 交替处理任务， 类似线程之间不断切换</li></ul><blockquote><p>并发的关键是你有处理多个任务的能力，不一定要同时。</p><p>并行的关键是你有同时处理多个任务的能力,强调的是同时.</p></blockquote><p>下面这篇文章可以参考解释上述概念</p><p><a href=https://blog.csdn.net/timemachine119/article/details/54091323>https://blog.csdn.net/timemachine119/article/details/54091323</a></p><h3 id=进程和线程使用>进程和线程使用
<a class=anchor href=#%e8%bf%9b%e7%a8%8b%e5%92%8c%e7%ba%bf%e7%a8%8b%e4%bd%bf%e7%94%a8>#</a></h3><ul><li>进程：内存独立， 线程共享同一进程的内存， 一个进程就像是一个应用程序（app）</li><li>进程是资源的组合， 线程是执行的单位</li><li>进程之间不能直接相互访问， 同一进程中的线程可以相互通讯</li><li>创建新的进程很消耗系统资源， 线程非常轻量， 只需要保存线程运行时的必要数据， 如上下文， 程序的堆栈信息</li><li>同一进程里的线程可以相互控制， 父进程可以控制子进程</li></ul><p>开多进程</p><ul><li>redis 缓存问题 读写分离， 单独设置缓存服务器来保存缓存， 读写都在该服务器上进行</li></ul><h4 id=关于-io-密集型任务-和--计算密集型任务>关于 IO 密集型任务 和 计算密集型任务
<a class=anchor href=#%e5%85%b3%e4%ba%8e-io-%e5%af%86%e9%9b%86%e5%9e%8b%e4%bb%bb%e5%8a%a1-%e5%92%8c--%e8%ae%a1%e7%ae%97%e5%af%86%e9%9b%86%e5%9e%8b%e4%bb%bb%e5%8a%a1>#</a></h4><ul><li><strong>CPU密集型</strong> - 多进程 计算</li><li><strong>IO密集型</strong> - 多线程 文本操作</li></ul><blockquote><p>如果多线程的进程是<strong>CPU密集型</strong>的，那多线程并不能有多少效率上的提升，相反还可能会因为线程的频繁切换，导致效率下降，推荐使用多进程；如果是<strong>IO密集型</strong>，多线程进程可以利用IO阻塞等待时的空闲时间执行其他线程，提升效率。所以我们根据实验对比不同场景的效率</p></blockquote><h4 id=线程常用方法>线程常用方法
<a class=anchor href=#%e7%ba%bf%e7%a8%8b%e5%b8%b8%e7%94%a8%e6%96%b9%e6%b3%95>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>start() 激活线程  <span style=color:#960050;background-color:#1e0010>（</span>开始<span style=color:#960050;background-color:#1e0010>）</span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>getName()  获取线程名称
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>setName()  设置
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>name : 获取或设置线程的名称
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>is_alive() <span style=color:#960050;background-color:#1e0010>：</span> 判断线程是否为激活状态
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>isAlive() <span style=color:#960050;background-color:#1e0010>：</span>判断线程是否为激活状态
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>setDaemon() 设置为后台线程或前台线程<span style=color:#960050;background-color:#1e0010>（</span>默认<span style=color:#960050;background-color:#1e0010>：</span><span style=color:#66d9ef>False</span><span style=color:#960050;background-color:#1e0010>）</span>;通过一个布尔值设置线程是否为守护线程<span style=color:#960050;background-color:#1e0010>，</span>必须在执行start()方法之后才可以使用<span style=color:#960050;background-color:#1e0010>。</span>如果是后台线程<span style=color:#960050;background-color:#1e0010>，</span>主线程执行过程中<span style=color:#960050;background-color:#1e0010>，</span>后台线程也在进行<span style=color:#960050;background-color:#1e0010>，</span>主线程执行完毕后<span style=color:#960050;background-color:#1e0010>，</span>后台线程不论成功与否<span style=color:#960050;background-color:#1e0010>，</span>均停止<span style=color:#960050;background-color:#1e0010>；</span>如果是前台线程<span style=color:#960050;background-color:#1e0010>，</span>主线程执行过程中<span style=color:#960050;background-color:#1e0010>，</span>前台线程也在进行<span style=color:#960050;background-color:#1e0010>，</span>主线程执行完毕后<span style=color:#960050;background-color:#1e0010>，</span>等待前台线程也执行完成后<span style=color:#960050;background-color:#1e0010>，</span>程序停止
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>isDaemon() <span style=color:#960050;background-color:#1e0010>：</span> 判断是否为守护线程
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>ident <span style=color:#960050;background-color:#1e0010>：</span>获取线程的标识符<span style=color:#960050;background-color:#1e0010>。</span>线程标识符是一个非零整数<span style=color:#960050;background-color:#1e0010>，</span>只有在调用了start()方法之后该属性才有效<span style=color:#960050;background-color:#1e0010>，</span>否则它只返回None<span style=color:#960050;background-color:#1e0010>。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>join() <span style=color:#960050;background-color:#1e0010>：</span>逐个执行每个线程<span style=color:#960050;background-color:#1e0010>，</span>执行完毕后继续往下执行<span style=color:#960050;background-color:#1e0010>，</span>该方法使得多线程变得无意义
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>t<span style=color:#f92672>.</span>run() <span style=color:#960050;background-color:#1e0010>：</span>线程被cpu调度后自动执行线程对象的run方法
</span></span></code></pre></div><p>==进程==</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> random
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> multiprocessing <span style=color:#f92672>import</span> Process
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>coding</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;AAAAAA, 进程号：</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> os<span style=color:#f92672>.</span>getpid())
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;BBBBBBB， 进程号：</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> os<span style=color:#f92672>.</span>getpid())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>play</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;1111111111， 进程号：</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> os<span style=color:#f92672>.</span>getpid())
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(random<span style=color:#f92672>.</span>randint(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;2222222222， 进程号：</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> os<span style=color:#f92672>.</span>getpid())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    p1 <span style=color:#f92672>=</span> Process(target<span style=color:#f92672>=</span>coding)
</span></span><span style=display:flex><span>    p2 <span style=color:#f92672>=</span> Process(target<span style=color:#f92672>=</span>play)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    p1<span style=color:#f92672>.</span>start()   <span style=color:#75715e># 进程之间在不阻塞的情况下是没有影响的，</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 阻塞   等执行完才会进行下一个</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># p1.join()</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># p2.join(timeout=3)  # 设置超时时间</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    p2<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>==线程==</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> threading
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Study</span>(threading<span style=color:#f92672>.</span>Thread):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, name):
</span></span><span style=display:flex><span>        super(Study, self)<span style=color:#f92672>.</span>__init__()
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>s_name <span style=color:#f92672>=</span> name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run</span>(self):  <span style=color:#75715e># 重构方法</span>
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;当前线程名称- </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> threading<span style=color:#f92672>.</span>current_thread()<span style=color:#f92672>.</span>name)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;开始学习！- </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> self<span style=color:#f92672>.</span>s_name)
</span></span><span style=display:flex><span>        time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;学习结束&#39;</span>)
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;当前线程名称- </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> threading<span style=color:#f92672>.</span>current_thread()<span style=color:#f92672>.</span>name)
</span></span><span style=display:flex><span>        <span style=color:#75715e># print(&#39;---&#39; * 20)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    s1 <span style=color:#f92672>=</span> Study(<span style=color:#e6db74>&#39;语文&#39;</span>)
</span></span><span style=display:flex><span>    s2 <span style=color:#f92672>=</span> Study(<span style=color:#e6db74>&#39;数学&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 守护线程  在 start 前  主线程结束 子线程会被强制结束</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># s1.daemon = True</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># s2.daemon = True</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># s1.start()</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 阻塞</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># s1.join()  # 阻塞在这里  等 s1 结束 再向下执行程序</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># s2.start()</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    s1<span style=color:#f92672>.</span>run()   <span style=color:#75715e># 都变为主线程  程序会顺序执行， 不存在同时执行</span>
</span></span><span style=display:flex><span>    s2<span style=color:#f92672>.</span>run()   <span style=color:#75715e># 相当于只是在执行函数， 并没有使用 多线程</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;测试结束-----&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># s1.run()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main() 
</span></span></code></pre></div><ul><li>线程锁</li></ul><p>多线程会共享资源， 需要线程锁， 当多个线程需要对同一资源进行修改时， 需要线程锁来保护资源， 避免操作资源出错</p><p>未加锁</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> threading
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyThread</span>(threading<span style=color:#f92672>.</span>Thread):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self):
</span></span><span style=display:flex><span>        super(MyThread, self)<span style=color:#f92672>.</span>__init__()
</span></span><span style=display:flex><span>        <span style=color:#75715e># self.s_name = s_name</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>global</span> n
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;number: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>,  threading name: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>%</span> (n, self<span style=color:#f92672>.</span>name))
</span></span><span style=display:flex><span>        n <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    thread_list <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>20</span>):
</span></span><span style=display:flex><span>        t1 <span style=color:#f92672>=</span> MyThread()
</span></span><span style=display:flex><span>        thread_list<span style=color:#f92672>.</span>append(t1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> thread_list:
</span></span><span style=display:flex><span>        t<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>加线程锁</p><ul><li>Lock() 和 RLock()</li><li><code>lock = threading.RLock()</code> 允许加多把锁</li><li><code>lock = threading.Lock（）</code> 只能加一把锁</li><li><code>lock = threading.BoundedSemaphore(3)</code> 同时允许三个线程进入， 同时进入的线程多于 3 时会引发 ValueError</li></ul><blockquote><p>锁的本质是内部有一个计数器，调用 acquire() 会使这个计数器 -1，release() 则是+1.计数器的值永远不会小于 0，当计数器到 0 时，再调用 acquire() 就会阻塞，直到其他线程来调用release()</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> threading
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>mylock <span style=color:#f92672>=</span> threading<span style=color:#f92672>.</span>Lock()  <span style=color:#75715e># 添加锁</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyThread</span>(threading<span style=color:#f92672>.</span>Thread):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self):
</span></span><span style=display:flex><span>        super(MyThread, self)<span style=color:#f92672>.</span>__init__()
</span></span><span style=display:flex><span>        <span style=color:#75715e># self.s_name = s_name</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>run</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> mylock<span style=color:#f92672>.</span>acquire():  <span style=color:#75715e># 锁定</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>global</span> n
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>&#39;number: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>,  threading name: </span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>%</span> (n, self<span style=color:#f92672>.</span>name))
</span></span><span style=display:flex><span>            n <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            mylock<span style=color:#f92672>.</span>release()  <span style=color:#75715e>#释放锁</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    thread_list <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>20</span>):
</span></span><span style=display:flex><span>        t1 <span style=color:#f92672>=</span> MyThread()
</span></span><span style=display:flex><span>        thread_list<span style=color:#f92672>.</span>append(t1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> thread_list:
</span></span><span style=display:flex><span>        t<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    n <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p><strong>事件Event</strong></p><p>python线程的事件用于主线程控制其他线程的执行，事件主要提供了三个方法 set、wait、clear。</p><p>事件处理的机制：全局定义了一个“Flag”，如果“Flag”值为 False，那么当程序执行 event.wait 方法时就会阻塞，如果“Flag”值为True，那么event.wait 方法时便不再阻塞。</p><ul><li>clear：将“Flag”设置为False</li><li>set：将“Flag”设置为True</li><li>Event.isSet() ：判断标识位是否为Ture</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span> <span style=color:#ae81ff>1</span> <span style=color:#75715e># 事件 event</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>2</span> lock <span style=color:#f92672>=</span> threading<span style=color:#f92672>.</span>Event()
</span></span><span style=display:flex><span> <span style=color:#ae81ff>3</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>task</span>(arg):
</span></span><span style=display:flex><span> <span style=color:#ae81ff>4</span>     time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span> <span style=color:#ae81ff>5</span>     <span style=color:#75715e># 锁住所有的线程</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>6</span>     lock<span style=color:#f92672>.</span>wait()
</span></span><span style=display:flex><span> <span style=color:#ae81ff>7</span>     print(arg)
</span></span><span style=display:flex><span> <span style=color:#ae81ff>8</span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span> <span style=color:#ae81ff>9</span>     t <span style=color:#f92672>=</span> threading<span style=color:#f92672>.</span>Thread(target<span style=color:#f92672>=</span>task,args<span style=color:#f92672>=</span>(i,))
</span></span><span style=display:flex><span><span style=color:#ae81ff>10</span>     t<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span><span style=color:#ae81ff>11</span> <span style=color:#66d9ef>while</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span><span style=color:#ae81ff>12</span>     value <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#39;&gt;&gt;:&#39;</span>)<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span><span style=color:#ae81ff>13</span>     <span style=color:#66d9ef>if</span> value <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;1&#39;</span>:
</span></span><span style=display:flex><span><span style=color:#ae81ff>14</span>         lock<span style=color:#f92672>.</span>set() <span style=color:#75715e># 打开锁，执行上面的print</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>15</span>         <span style=color:#75715e># lock.clear() # 再锁上</span>
</span></span></code></pre></div><h4 id=线程池>线程池
<a class=anchor href=#%e7%ba%bf%e7%a8%8b%e6%b1%a0>#</a></h4><ul><li>会让线程 更具线程池设置的个数进行 执行， 每次同时执行的个数是设置的个数</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> concurrent.futures <span style=color:#f92672>import</span> ThreadPoolExecutor
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>task</span>(i):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;hello!, 编号：&#39;</span>, i)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pool <span style=color:#f92672>=</span> ThreadPoolExecutor(<span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>50</span>):
</span></span><span style=display:flex><span>    pool<span style=color:#f92672>.</span>submit(task, i)   <span style=color:#75715e># 每次输出 三个 hello</span>
</span></span></code></pre></div><p>线程池的回调函数</p><ul><li>将前面函数的返回值作为后面的结果进行传递</li><li><code>future.add_done_callback(add1000)</code></li><li><code>num = future.result()</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> concurrent.futures <span style=color:#f92672>import</span> ThreadPoolExecutor
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>add100</span>(num):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;我是 100 &#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> num <span style=color:#f92672>+</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>add1000</span>(future):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;我是 + 1000&#39;</span>)
</span></span><span style=display:flex><span>    num <span style=color:#f92672>=</span> future<span style=color:#f92672>.</span>result()
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>    print(num <span style=color:#f92672>+</span> <span style=color:#ae81ff>1000</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    pool <span style=color:#f92672>=</span> ThreadPoolExecutor(<span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> num <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>50</span>):
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#39;开始计算数字：</span><span style=color:#e6db74>%s</span><span style=color:#e6db74> ！&#39;</span> <span style=color:#f92672>%</span> num)
</span></span><span style=display:flex><span>        future <span style=color:#f92672>=</span> pool<span style=color:#f92672>.</span>submit(add100, num)
</span></span><span style=display:flex><span>        future<span style=color:#f92672>.</span>add_done_callback(add1000)  <span style=color:#75715e># 前面的结果返回后进行下个函数的调用</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><h4 id=多进程>多进程
<a class=anchor href=#%e5%a4%9a%e8%bf%9b%e7%a8%8b>#</a></h4><ul><li>多进程之间可以数据共享</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> multiprocessing <span style=color:#f92672>import</span> Process
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>task</span>():
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;hello!&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>        p <span style=color:#f92672>=</span> Process(target<span style=color:#f92672>=</span>task)
</span></span><span style=display:flex><span>        <span style=color:#75715e># p.daemon = True</span>
</span></span><span style=display:flex><span>        p<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span>        <span style=color:#75715e># p.join()</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;主进程结束！！！&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#75715e>###  数据共享</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> multiprocessing <span style=color:#f92672>import</span> Process, Array
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>task</span>(num, li):
</span></span><span style=display:flex><span>    time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    li[num] <span style=color:#f92672>=</span> num
</span></span><span style=display:flex><span>    print(list(li))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    li <span style=color:#f92672>=</span> Array(<span style=color:#e6db74>&#39;i&#39;</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>        p <span style=color:#f92672>=</span> Process(target<span style=color:#f92672>=</span>task, args<span style=color:#f92672>=</span>(i, li))
</span></span><span style=display:flex><span>        <span style=color:#75715e># p.daemon = True</span>
</span></span><span style=display:flex><span>        p<span style=color:#f92672>.</span>start()
</span></span><span style=display:flex><span>        <span style=color:#75715e># p.join()</span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;主进程结束！！！&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><h4 id=进程池>进程池
<a class=anchor href=#%e8%bf%9b%e7%a8%8b%e6%b1%a0>#</a></h4><p>和线程池差不多</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> concurrent.futures <span style=color:#f92672>import</span> ProcessPoolExecutor <span style=color:#66d9ef>as</span> PPE
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#75715e>#基本用法</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>task</span>(arg):
</span></span><span style=display:flex><span>     time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>     print(arg)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> pool <span style=color:#f92672>=</span> PPE(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>     pool<span style=color:#f92672>.</span>submit(task,i)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#75715e># 进程池回调</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>call</span>(arg):
</span></span><span style=display:flex><span>     data <span style=color:#f92672>=</span> arg<span style=color:#f92672>.</span>result()
</span></span><span style=display:flex><span>     print(data)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>task</span>(arg):
</span></span><span style=display:flex><span>     print(arg)
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>return</span> arg<span style=color:#f92672>+</span><span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> pool <span style=color:#f92672>=</span> PPE(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span> <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>10</span>):
</span></span><span style=display:flex><span>     obj <span style=color:#f92672>=</span> pool<span style=color:#f92672>.</span>submit(task,i)
</span></span><span style=display:flex><span>     obj<span style=color:#f92672>.</span>add_done_callback(call)
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#线程和进程>线程和进程</a><ul><li></li><li><a href=#进程和线程使用>进程和线程使用</a></li></ul></li></ul></nav></div></aside></main></body></html>